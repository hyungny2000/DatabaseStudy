## Age

#### 개념
1. age(XID) = 현재 XID - 생성 당시의 XID
2. 생성된 지 얼마나 오래되었는지를 나타내는 지표
3. 트랜잭션이 하나씩 실행될 때마다 데이터베이스, 테이블, 튜플이 다 같이 Age(나이)를 한 살씩 먹는다.
4. Vacuum, Vacuum Freeze 이후 데이터베이스, 테이블, 튜플의 Age(나이)는 어려진다.

#### 각 오브젝트의 나이 계산
1. 데이터베이스 Age계산
   ```
   select datname, age(datfrozenxid) from pg_database;
   ```
2. 테이블의 Age 계산
   ```
   select relname, age(relfrozenxid) from pg_class;
   ```
3. 튜플의 Age 계산
   ```
   select age(xmin) from table;
   ```
4. **항상 데이터베이스 > 테이블 > 튜플 순서로 Age가 많다.**
   ```
   create database nano; - 트랜잭션 수행. nano = 101
   \c nano;
   create table test1 (col1 int primary key); -- 트랜잭션 수행. nano = 102, test1=1
   insert into test1 (col1) values (1); -- 트랜잭션 수행. nano=103, test1=2, 1번 data = 1
   ```
   - 데이터 1개 insert하기 위해 데이터베이스 생성, 테이블 생성작업을 선행해야 하기 때문
   - 최초 데이터베이스 생성 시 나이는 Template 데이터베이스와 동일하다. 여기서는 기본 템플릿(template1)의 나이가 101이었다고 가정하면, nano데이터베이스의 나이는 101이 된다.
   - test1 테이블을 생성한다. 테이블 생성도 트랜잭션이므로 nano데이터베이스, test1 테이블은 1살씩 나이를 먹는다.
   - test1 테이블에 데이터를 추가한다. 이 또한 트랜잭션이므로 nano데이터베이스, test1테이블, 삽입한 튜플 각각 1살씩 나이를 먹는다.
  
#### Vacuum에 Age가 필요한 이유
1. XID Wraparound 방지
2. 불필요한 vacuum 부하 감소


#### Vacuum 전후 Age 변화 테스트

