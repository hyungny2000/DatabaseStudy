## infomask의 XMIN,XMIN 상태변화 확인
#### 모니터링 쿼리
###### 테스트 테이블 생성 및 조회 쿼리
```
create table test1 (col1 int primary key);
select ctid, xmin, xmax, col1 from test1;
```
- ctid, xmin, xmax : 의사컬럼(Pseudo Column)

###### infomask의 XMIN, XMAX 상태 모니터링 쿼리
```
SELECT lp, t_xmin, t_xmax,t_infomask::bit(16)
           ,b'0000000100000000' & t_infomask::bit(16) = b'0000000100000000' as XMIN_COMMITTED
           ,b'0000001000000000' & t_infomask::bit(16) = b'0000001000000000' as XMIN_INVALID
           ,b'0000010000000000' & t_infomask::bit(16) = b'0000010000000000' as XMAX_COMMITTED
           ,b'0000100000000000' & t_infomask::bit(16) = b'0000100000000000' as XMAX_INVALID
           ,t_data
FROM heap_page_items(get_raw_page('test1', 0));
```
각 플래그 별로 TRUE, FALSE로 표시된다.
- XMIN_COMMITTED : TRUE이면 XMIN 트랜잭션이 현재 COMMIT된 상태, FALSE이면 XMIN트랜잭션이 ROLLBACK된 상태
- XMIN_INVALID : TRUE이면 XMIN 트랜잭션이 유효하지 않음, FALSE이면 XMIN트랜잭션이 유효한 상태
- XMAX_COMMITTED : TRUE이면 XMAX 트랜잭션이 현재 COMMIT된 상태, FALSE이면 XMAX트랜잭션이 ROLLBACK된 상태
- XMAX_INVALID : TRUE이면 XMAX 트랜잭션이 유효하지 않음, FALSE이면 XMAX트랜잭션이 유효한 상태

#### 테스트 방법
- 각각 다른 CMD창에 Session#1, Session#2 두 창을 띄워놓는다.
- Session#1에서 test1 테이블에 대한 CUD를 실행하고 Commit/Rollback을 한다.
- Session#2에서 테이블 조회쿼리, XMIN/XMAX상태를 모니터링한다.

#### Transaction In Progress
insert into test1 values (1);명령을 실행하고 커밋하지 않는다. 
###### Session#1
```
\c nano
truncate table test1;
\set autocommit off;
begin;
insert into test1 values (1);
... (커밋 안함)....
```

###### Session#2
```
```

#### Transaction Commit
insert 트랜잭션을 커밋하여 종료한 다음음 튜플 상태를 조회한다.
###### Session#1
```
commit;
```

###### Session#2
```
```
###### Session#1
```
checkpoint;
```
- 체크포인트를 강제실행하여 Dirty버퍼를 디스크로 내려 페이지에서 infomask 변경을 확인한다.

###### Session#2
```
```

#### Transaction Rollback#1
insert into test1 values (2); 명령을 rollback한다.
###### Session#1
```
begin;
insert into test1 values (2);
Rollback;
checkpoint;
```

###### Session#2
```
```

#### Transaction Rollback#2
delete from test1 where col1 = 1; 명령을 rollback한다.

###### Session#1
```
begin;
delete from test1 where col1 = 1;
Rollback;
checkpoint;
```

###### Session#2
```
```

#### Transaction Commit
delete from test1 where col1 = 1; 명령을 commit;한다.

###### Session#1
```
begin;
delete from test1 where col1 = 1;
commit;
checkpoint;
```

###### Session#2
```
```
