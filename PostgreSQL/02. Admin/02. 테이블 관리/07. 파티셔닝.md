# 파티셔닝
## 파티셔닝 개요
### 파티셔닝 정의
큰 테이블을 파티션(Partition)이라는 작은 단위로 나누어 관리하는 행위를 파티셔닝이라고 한다.

### 파티셔닝이 필요한 시나리오
모 이동통신사 사업팀에서는 BIILING테이블을 SELECT하여 매달 청구서를 작성, 배포하고 있다. BIILING 테이블은 **가입자 수 5000만 명 (매월 5000만 건) 보관주기 10년 (5000만 * 12개월 * 10년 = 60억 건)** 정도 되는 매우 큰 비파티션 테이블이다. 이 테이블에서 지난 한 달 분량(5000만 건)의 데이터만 조회해야 할 때 다음 문제가 발생한다.
1. Table Full Scan으로 조회
   - 조건에 맞건 안맞건 **일단 전체 60억 건을 조회한 다음, 한 달 분량의 데이터 5000만 건만 가지고 나머지 59억 5천만 건은 내다 버려야 한다.**
   - 시간이 매우 오래 걸리는데 비해 5000만/60억으로 매우 비효율적이다.
2. Index Range Scan으로 조회
   - 지난 한 달 분량의 5000만 건만 Index Range Scan할 수 있음 (있다고 하기도 애매하다. 5000만 건은 보통 인덱스 Scan을 안한다.)
   - 최소 5000만 번의 Random Access와 Single Block I/O를 수반하므로 매우 비효율적이다. 생수병 5000만 개를 박스단위가 아닌, 한 개씩 손수 배달한다고 상상해보자.

이럴 때, 만약 지난달(5000만 건 단위) 테이블 하나만 Table Full Scan할 수 있다면, 청구서 작업은 훨씬 쉽게 끝날 것이다. 여기서 월 단위(5000만 건 단위)의 테이블이 파티션(Partition)에 해당한다고 보면 된다.

### 파티셔닝의 이점
1. Partition Pruning
   - 파티션 테이블에서 파티션은 마치 하나의 물리적 테이블, 파티션 테이블은 마치 뷰(View)처럼 동작한다.
   - Table Full Scan할 때에도 where 조건절을 분석하여 필요한 파티션만 선별하여 Scan하는 기능(Partition Pruning)이 있다.
2. 테이블 보관주기 관리에 유리함
   - Delete쿼리로 보관주기를 관리할 경우, 삭제대상 데이터를 Select, Delete하는 부하가 만만치 않다.
   - 파티션 Drop,Truncate는 파티션 세그먼트를 해제하는 일로, 부하가 거의 없이 원하는 파티션을 삭제할 수 있다.
  
### 파티셔닝의 종류
#### 인덱스 파티셔닝에 따른 구분
1. 로컬 파티션 (Local Partition)
- **테이블의 파티션과 인덱스 파티션이 동일한 기준으로 파티션됨이 보장**될 때 로컬 파티션이라고 한다.
- 인덱스 파티션을 별도 관리할 필요가 없어 관리에 용이하며, 직관적이므로 널리 사용된다.
- 현존하는 모든 RDBMS가 로컬 파티션을 지원함.
2. 글로벌 파티션 (Global Partition)
- 테이블의 파티션과 인덱스 파티셔닝 기준 데이터가 다른 파티셔닝.
- 테이블의 파티션과 인덱스 파티션이 동일한 기준으로 파티셔닝됨이 보장되지 않는 경우.
- 현재는 Oracle만 글로벌 파티셔닝을 지원함.

#### 파티션 컬럼이 

#### 파티셔닝 기준에 따른 구분
1. 범위 파티션(Range Partition)
    - 이력, 로그테이블을 일/월/연 단위로 파티셔닝하는 방법
    - 가장 많이 사용함.
3. 목록 파티션(List Partition)
    - 지역,코드 별로 파티셔닝하는 방법
5. 해시 파티션(Hash Partition)
    - 특정 값의 해시값 별로 파티셔닝하는 방법
    - 입출력 분산 등 성능이슈 해소를 위해 사용하지만, 자주 쓰이지는 않음.
4. 복합 파티션 (Composite Partition)
    - 둘 이상의 컬럼으로 파티셔닝하는 방법
    - 자주 쓰이지는 않음.
  
# PostgreSQL의 파티셔닝 

## 상속을 이용한 파티셔닝

## 선언적 파티셔닝

