# B-Tree 인덱스

## 정의
- B-Tree 구조의 인덱스.
- PostgreSQL을 포함한 거의 모든 DBMS에서 보편적으로 권고하는 인덱스.

## B-Tree 구조
### 구조 및 용어
B-Tree는 흡사 나무와 비슷한 구조를 하고 있다. 
1. Root Node : 인덱스 최상단, 즉 뿌리에 해당하는 노드. 여기서 노드는 서버가 아니라 데이터 블록을 의미한다.
2. Branch Node : 인덱스 중간, 가지에 해당하는 노드. 인덱스 크기가 작으면 Branch Node가 생략되는 경우가 있다.
3. Leaf Node : 인덱스 최말단, 잎에 해당하는 노드. 검색대상 데이터와 Row를 바로 찾아갈 수 있는 Pointer 정보가 있다. Leaf Node는 이웃한 Leaf Node와 연결되어 있으며, 데이터를 기준으로 항상 정렬된 상태를 유지하도록 되어 있다.
4. Level : Root Node부터 Leaf Node에 이르기까지 거쳐야 하는 단계를 칭한다.
5. Random Access : 인덱스 Leaf Node에서 해당되는 테이블 페이지를 Fetch하는 과정을 Random Access라고 한다.
```
                                          ____ [Leaf Node]
                              2.         |         | 
               _______ [Branch Node#1] __|____ [Leaf Node]
     1.        |                         |     3.  |                                       4.
[Root Node]----|                         |____ [Leaf Node] -----(Ramdom Access)------> [Table Page]
               |                                   |
               |                          ____ [Leaf Node]
               _______ [Branch Node#2]___|         |
                                         |____ [Leaf Node]

     |__________________(Level = 2)________________|
```
[B-Tree 인덱스 전체 구조]
```

            Leaf Node#1
| col1  |          Pointer        |           |  col1  |        Pointer           |           |  col1  |        Pointer           |
|  가   |  BufferTag#1 (offset=0) |           |   나   |  BufferTag#1 (offset=6)  |           |   라   |  BufferTag#2 (offset=1)  |
|  가   |  BufferTag#1 (offset=1) |           |   나   |  BufferTag#1 (offset=7)  |           |   라   |  BufferTag#2 (offset=2)  |
|  가   |  BufferTag#1 (offset=2) | <-------> |   나   |  BufferTag#3 (offset=0)  | <-------> |   라   |  BufferTag#2 (offset=3)  |
|  가   |  BufferTag#2 (offset=0) |           |   다   |  BufferTag#1 (offset=8)  |           |   마   |  BufferTag#2 (offset=4)  |
|  가   |  BufferTag#1 (offset=4) |           |   다   |  BufferTag#1 (offset=9)  |           |   바   |  BufferTag#2 (offset=5)  |
|  나   |  BufferTag#1 (offset=5) |           |   라   |  BufferTag#1 (offset=10) |           |   사   |  BufferTag#2 (offset=6)  |

```
[B-Tree 인덱스 Leaf Node 구조]
