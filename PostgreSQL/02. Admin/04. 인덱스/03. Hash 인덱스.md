# Hash 인덱스

## 정의
- 실제 데이터 대신, 데이터의 해시함수 연산 값을 가지는 인덱스
- 해시함수, 해시버켓, 오버플로 페이지로 구성됨.
- XX기간 인덱스의 특성상, 과거보다 최근 데이터 페이지에만 입출력이 몰리는 핫 블록(Hot Block)에 대비하기 위한 특수 목적의 인덱스

## 데이터 해시연산 결과 예시와 해시 인덱스 구조 비교
```
        [해시연산결과]                              [Hash Bucket Page]     [Overflow Page]
|       Data       | Hash(x) |                ____|     Hash#1      | - [Page#1] - [Page#2]
| 2025-01-01 09:00 |  ASDXD  |                |---|     Hash#2      |
| 2025-01-01 09:01 |  FFESX  |                |---|     Hash#3      | - [Page#3] - [Page#4]
| 2025-01-01 09:02 |  XERWF  |                |---|     Hash#4      |
| 2025-01-01 09:03 |  0XDFE  |         Hash(x) ---|     Hash#5      |     
| 2025-01-01 09:04 |  ERXFD  |                |---|     Hash#6      | - [Page#5] - [Page#6]
| 2025-01-01 09:05 |  WERWF  |                |---|     Hash#7      |
| 2025-01-01 09:06 |  XREWF  |                |---|     Hash#8      |
```
### 해시함수
- 데이터의 해시값을 구하는 역할.
- B-Tree의 경우 연속된 데이터는 보통 하나의 Leaf Node에 몰려 있게 되나, 이들의 해시값은 불연속적이므로 해시인덱스 곳곳에 골고루 분포해 있게 된다.

### 메타 페이지
- 해시 인덱스 전체의 메타데이터를 보관하는 페이지
- 버킷 개수, 할당된 페이지 정보 등을 보유

### 디렉토리 페이지
- 각 해시버킷이 어느 페이지에 있는지 저장하는 역할

### 버킷 페이지
- 각 해시값을 가지는 버킷 페이지
- 해당 버킷 페이지에 동일한 해시값을 가지는 오버플로 페이지들이 연결 리스트처럼 엮여 있다.

### 오버플로 페이지
- 실제 데이터가 저장된 최말단 페이지
- 동일한 해시값을 가지는 해시버켓과 연결리스트로 연결되어 있다.
- 오버플로 페이지가 많이 연결될 수록 조회성능은 떨어진다.

## 해시 인덱스의 특징
1. 고유성(Uniqueness) 체크 불가
   - 해시 충돌(Hash Collision)로 인해, 서로 다른 데이터도 같은 해시값이 산출될 수 있음
   - 하나의 해시값이 둘 이상의 데이터를 대표할 수도 있으므로 고유성 체크는 할 수 없음
2. 동등조건 연산자만 사용가능
   - 연속된 데이터의 해시값은 불연속적이므로 부등호 연산자로 범위지정은 할 수 없음.
3. 단일 인덱스만 지원
4. UUID, Varchar 등 대용량 인덱스 데이터의 경우 B-Tree보다 용량을 덜 차지함
   - 해시함수는 결과값의 자리수를 통일하기 때문.

## B-Tree Index와 비교
| 항목 | B-Tree | 해시인덱스 | 
| --- | --- | ---- |
| 동둥조건 성능 | 일반적으로 빠름 | 특정 조건에서 훨씬 빠름 |
| 범위조건 사용 | 가능 | 불가능 | 
| 다중컬럼 인덱스 | 지원 | 미지원 | 
