## 리눅스 OS커널파라미터 설정
> (출처 : FosterDBMS Installation Guide)
> 기능 실습만 하시는거면 이 챕터는 필요없습니다. 운영시 참고용으로 만들었으니 건너뛰실 분은 건너뛰십시오.

#### SYSTEM V IPC 파라미터
###### SHMMAX
- 공유 메모리 세그먼트의 최대 크기 (Bytes)
- shared_buffer 값

###### SHMALL
- 사용 가능한 총 공유메모리 양
  - Bytes일 경우 : SHMMAX
  - Pages일 경우 : ceil(SHMMAX/PAGE_SIZE)
 
###### SHMMNI
- 세마포어 식별자의 최대 수 (sets)
- 최소 ceil((max_connections + autovacuum_max_workers + max_wal_senders + max_worker_processes + 5 ) /16)

###### SHMMNS
- 시스템 전체의 최대 세마포어 수
- 최소 ceil((max_connections + autovacuum_max_workers + max_wal_senders + max_worker_processes + 5 ) /16) + 17

###### 파라미터 확인
```
systemctl kernel.shmmax
systemctl kernel.shmall

cat /proc/sys/kernel/sem
   250    32000     32        128
(SEMMSL   SEMMNS   SEMOPM   SEMMNI)
```

###### 파라미터 일시적 설정
```
systemctl -w kernel.shmmax=268435456
systemctl -w kernel.shmall=268435456
systemctl -w kernel.sem="250 32000 32 128"
```

###### 파라미터 영구설정
```
vi /etc/systemctl.conf

kernel.symmax=268435456
kernel.shmall=268435456
kernel.sem="250 32000 32 128"
```

#### fs.file-max
- 시스템 전체에서 최대로 오픈할 수 있는 파일의 개수를 설정.
- 파라미터 값이 너무 작으면 오류발생 가능. 최소 권고값 65536.
- 파라미터 확인
  ```
  systemctl fs.file-max
  fs.file-max = 786074
  ```
- 파라미터 설정
  ```
  (일시적 설정)
  systemctl -w fs.file-max=786074
  
  (영구설정)
  vi /etc/systemctl.conf

  fs.file-max = 786074

  :wq

  vi /etc/security/limits.conf
  postgres       soft    nofile      65536
  postgres       hard    nofile      65536
  ```

#### Systemd RemoveIPC
- systemd를 사용할 경우 IPC리소스가 OS에 의해 조기에 제거되지 않도록 해야 한다.
```
vi /etc/systemd/logind.conf
RemoveIPC=no
```

#### Memory Overcommit
- 


  
